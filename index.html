<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calibrate - Decision Intelligence System</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        body { 
            margin: 0; 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
        }
        .serif { font-family: 'DM Serif Display', serif; }
        .cosmic-bg {
            background: radial-gradient(ellipse at top, #1a1a2e 0%, #0a0a0a 50%);
        }
        .cosmic-card {
            background: rgba(20, 20, 30, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .cosmic-glow {
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.3);
        }
        .stat-orb {
            background: radial-gradient(circle at 30% 30%, rgba(139, 92, 246, 0.3), rgba(59, 130, 246, 0.2));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        .gradient-text {
            background: linear-gradient(135deg, #a78bfa 0%, #60a5fa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .cosmic-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.5), transparent);
        }
        .message-bubble {
            animation: fadeInUp 0.4s ease-out;
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        input::placeholder, textarea::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }
        .constellation-dot {
            width: 2px;
            height: 2px;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            position: absolute;
            animation: twinkle 3s ease-in-out infinite;
        }
        @keyframes twinkle {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }
        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(139, 92, 246, 0.2);
            outline: none;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #a78bfa 0%, #60a5fa 100%);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
        }
        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #a78bfa 0%, #60a5fa 100%);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
        }
    </style>
</head>
<body>
    <div id="root"></div>

<script>
    const { createElement: h, useState, useEffect, useRef, useMemo, Fragment } = React;

    // Icons
    const Brain = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('circle', { cx: "12", cy: "12", r: "10", opacity: "0.3" }),
        h('path', { d: "M12 2a10 10 0 0 1 0 20" }),
        h('circle', { cx: "12", cy: "12", r: "3", fill: "currentColor" })
    );

    const Sparkles = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" }),
        h('path', { d: "M5 3v4", opacity: "0.5" }),
        h('path', { d: "M19 17v4", opacity: "0.5" }),
        h('path', { d: "M3 5h4", opacity: "0.5" }),
        h('path', { d: "M17 19h4", opacity: "0.5" })
    );

    const Send = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z" }),
        h('path', { d: "m21.854 2.147-10.94 10.939" })
    );

    const X = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "M18 6 6 18" }),
        h('path', { d: "m6 6 12 12" })
    );

    const Search = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('circle', { cx: "11", cy: "11", r: "8" }),
        h('path', { d: "m21 21-4.3-4.3" })
    );

    const Eye = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z" }),
        h('circle', { cx: "12", cy: "12", r: "3" })
    );

    const Plus = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "M12 5v14M5 12h14" })
    );

    const BarChart = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "M3 3v16a2 2 0 0 0 2 2h16" }),
        h('path', { d: "M18 17V9M13 17V5M8 17v-3" })
    );

    const Lock = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('rect', { width: "18", height: "11", x: "3", y: "11", rx: "2", ry: "2" }),
        h('path', { d: "M7 11V7a5 5 0 0 1 10 0v4" })
    );

    const RefreshCw = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" }),
        h('path', { d: "M21 3v5h-5" }),
        h('path', { d: "M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" }),
        h('path', { d: "M3 21v-5h5" })
    );

    // ==================== QUADRANT SYSTEM ====================
    const QuadrantSystem = {
      dimensions: {
        thinkingStyle: ['Analytical', 'Intuitive'],
        decisionSpeed: ['Deliberate', 'Rapid'],
        riskTolerance: ['Conservative', 'Bold'],
        informationNeed: ['Comprehensive', 'Sufficient']
      },

      types: {
        'Analytical-Deliberate-Conservative-Comprehensive': { title: 'Strategic Architect', description: 'Methodical planner who excels at complex analysis', strengths: ['Risk assessment', 'Long-term planning', 'Detail orientation'], blindSpots: ['Analysis paralysis', 'Missed opportunities', 'Slow in crisis'], teamValue: 'Prevents costly mistakes through thorough evaluation' },
        'Analytical-Deliberate-Bold-Comprehensive': { title: 'Calculated Innovator', description: 'Data-driven risk-taker who bets on analyzed opportunities', strengths: ['Informed risk-taking', 'Strategic disruption', 'Evidence-based boldness'], blindSpots: ['Overconfidence in models', 'Slow to pivot', 'Data blind spots'], teamValue: 'Drives innovation with analytical backing' },
        'Analytical-Rapid-Conservative-Comprehensive': { title: 'Efficient Optimizer', description: 'Quick analyst who streamlines without recklessness', strengths: ['Rapid problem-solving', 'Pattern recognition', 'Efficient execution'], blindSpots: ['Premature optimization', 'Missing nuance', 'Burnout risk'], teamValue: 'Accelerates execution while maintaining quality' },
        'Analytical-Rapid-Bold-Comprehensive': { title: 'Decisive Strategist', description: 'Fast, data-informed decision-maker who seizes opportunities', strengths: ['Speed + accuracy', 'Competitive advantage', 'Crisis management'], blindSpots: ['Overcommitment', 'Team overwhelm', 'Sustainability'], teamValue: 'Capitalizes on time-sensitive opportunities' },
        'Intuitive-Deliberate-Conservative-Comprehensive': { title: 'Wise Counselor', description: 'Thoughtful advisor who reads between the lines', strengths: ['Cultural intelligence', 'People reading', 'Long-term relationships'], blindSpots: ['Overthinking signals', 'Risk aversion', 'Slow decisions'], teamValue: 'Identifies human factors others miss' },
        'Intuitive-Deliberate-Bold-Comprehensive': { title: 'Visionary Leader', description: 'Bold thinker who trusts conviction backed by reflection', strengths: ['Vision setting', 'Inspiring others', 'Strategic courage'], blindSpots: ['Confirmation bias', 'Groupthink', 'Execution gaps'], teamValue: 'Sets direction and rallies teams toward ambitious goals' },
        'Intuitive-Rapid-Conservative-Comprehensive': { title: 'Adaptive Navigator', description: 'Quick reader of situations who stays safe', strengths: ['Crisis adaptation', 'Social dynamics', 'Quick pivots'], blindSpots: ['Risk paralysis', 'Overthinking gut', 'Missed upside'], teamValue: 'Reads room quickly and maintains stability' },
        'Intuitive-Rapid-Bold-Comprehensive': { title: 'Inspired Maverick', description: 'Fast, fearless decision-maker who trusts instinct', strengths: ['Breakthrough moves', 'Inspiring action', 'Seizing moments'], blindSpots: ['Recklessness', 'Poor follow-through', 'Team friction'], teamValue: 'Makes bold moves others wouldn\'t dare' },
        'Analytical-Deliberate-Conservative-Sufficient': { title: 'Pragmatic Planner', description: 'Efficient analyst who knows when enough is enough', strengths: ['Time efficiency', 'Practical decisions', 'Resource management'], blindSpots: ['Under-researching', 'Missing complexity', 'False confidence'], teamValue: 'Delivers solid decisions without overthinking' },
        'Analytical-Deliberate-Bold-Sufficient': { title: 'Strategic Disruptor', description: 'Calculated risk-taker who moves with lean data', strengths: ['Fast innovation', 'Lean methodology', 'Market timing'], blindSpots: ['Premature bets', 'Incomplete models', 'Overlooking risks'], teamValue: 'Drives change without analysis paralysis' },
        'Analytical-Rapid-Conservative-Sufficient': { title: 'Quick Resolver', description: 'Fast problem-solver who avoids unnecessary risk', strengths: ['Rapid execution', 'Safe optimization', 'Efficiency'], blindSpots: ['Shallow analysis', 'Missed innovation', 'Stagnation'], teamValue: 'Clears backlogs and maintains quality' },
        'Analytical-Rapid-Bold-Sufficient': { title: 'Agile Executor', description: 'Lightning-fast decision-maker who bets quickly', strengths: ['Speed to market', 'Opportunity capture', 'Momentum'], blindSpots: ['Hasty errors', 'Burnout', 'Poor sustainability'], teamValue: 'Captures fleeting opportunities others miss' },
        'Intuitive-Deliberate-Conservative-Sufficient': { title: 'Thoughtful Guardian', description: 'Careful intuitive who trusts refined hunches', strengths: ['Judgment calls', 'People wisdom', 'Safe intuition'], blindSpots: ['Over-caution', 'Slow action', 'Limited data'], teamValue: 'Provides wise counsel without over-analyzing' },
        'Intuitive-Deliberate-Bold-Sufficient': { title: 'Bold Visionary', description: 'Confident leader who bets on refined instinct', strengths: ['Inspiring direction', 'Courageous moves', 'Vision clarity'], blindSpots: ['Blind spots', 'Overconfidence', 'Groupthink'], teamValue: 'Sets bold direction with conviction' },
        'Intuitive-Rapid-Conservative-Sufficient': { title: 'Instinctive Protector', description: 'Quick intuitive who errs on side of safety', strengths: ['Threat detection', 'Quick safety', 'Social agility'], blindSpots: ['False alarms', 'Risk aversion', 'Missed upside'], teamValue: 'Catches threats early and pivots quickly' },
        'Intuitive-Rapid-Bold-Sufficient': { title: 'Lightning Catalyst', description: 'Fearless instinct-driven mover who acts instantly', strengths: ['Instant action', 'High energy', 'Breaking norms'], blindSpots: ['Impulsiveness', 'Poor planning', 'Chaos'], teamValue: 'Initiates action when others hesitate' }
      },

      getProfile: (dims) => {
        const key = `${dims.thinkingStyle}-${dims.decisionSpeed}-${dims.riskTolerance}-${dims.informationNeed}`;
        return { ...QuadrantSystem.types[key], dimensions: dims };
      }
    };

    // ==================== ONBOARDING SCREENS ====================
    const OnboardingScreen = ({ step, onNext, onBack, userData, setUserData }) => {
      const [input, setInput] = useState('');

      if (step === 1) {
        return h('div', { className: "cosmic-bg min-h-screen flex items-center justify-center p-6" },
          h('div', { className: "max-w-2xl w-full cosmic-card rounded-3xl p-12 text-center" },
            h('div', { className: "animate-float mb-8" },
              h(Brain, { className: "w-20 h-20 mx-auto text-purple-400" })
            ),
            h('h1', { className: "text-5xl serif mb-6 gradient-text" }, "Welcome to Calibrate"),
            h('p', { className: "text-xl text-gray-400 mb-8 leading-relaxed" }, 
              "A decision intelligence system that helps you understand your judgment patterns and improve over time."
            ),
            h('button', {
              onClick: onNext,
              className: "px-8 py-4 rounded-full cosmic-card cosmic-glow hover:scale-105 transition-all font-light"
            }, "Begin Journey →")
          )
        );
      }

      if (step === 2) {
        return h('div', { className: "cosmic-bg min-h-screen flex items-center justify-center p-6" },
          h('div', { className: "max-w-2xl w-full cosmic-card rounded-3xl p-12" },
            h('h2', { className: "text-3xl serif mb-6" }, "Tell us about yourself"),
            h('p', { className: "text-gray-400 mb-8" }, "This helps us personalize your experience."),
            
            h('div', { className: "space-y-6 mb-8" },
              h('div', null,
                h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "Your Name"),
                h('input', {
                  type: "text",
                  value: userData.name || '',
                  onChange: (e) => setUserData({ ...userData, name: e.target.value }),
                  className: "w-full px-4 py-3 rounded-xl cosmic-card border-none focus:cosmic-glow focus:outline-none",
                  placeholder: "Enter your name"
                })
              ),
              h('div', null,
                h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "Primary Goal (Optional)"),
                h('input', {
                  type: "text",
                  value: userData.goal || '',
                  onChange: (e) => setUserData({ ...userData, goal: e.target.value }),
                  className: "w-full px-4 py-3 rounded-xl cosmic-card border-none focus:cosmic-glow focus:outline-none",
                  placeholder: "e.g., Improve investment decisions"
                })
              )
            ),

            h('div', { className: "flex gap-4" },
              h('button', {
                onClick: onBack,
                className: "px-6 py-3 rounded-full cosmic-card hover:cosmic-glow transition-all font-light"
              }, "← Back"),
              h('button', {
                onClick: onNext,
                disabled: !userData.name,
                className: "flex-1 px-6 py-3 rounded-full cosmic-card cosmic-glow hover:scale-105 transition-all font-light disabled:opacity-50 disabled:cursor-not-allowed"
              }, "Continue →")
            )
          )
        );
      }

      if (step === 3) {
        const questions = [
          { 
            dim: 'thinkingStyle', 
            question: 'When making important decisions, do you primarily rely on:',
            options: [
              { value: 'Analytical', label: 'Data and logical analysis' },
              { value: 'Intuitive', label: 'Gut feelings and pattern recognition' }
            ]
          },
          { 
            dim: 'decisionSpeed', 
            question: 'Your typical decision-making pace is:',
            options: [
              { value: 'Deliberate', label: 'Thoughtful and measured' },
              { value: 'Rapid', label: 'Quick and decisive' }
            ]
          },
          { 
            dim: 'riskTolerance', 
            question: 'When facing uncertainty, you tend to be:',
            options: [
              { value: 'Conservative', label: 'Cautious and protective' },
              { value: 'Bold', label: 'Adventurous and opportunistic' }
            ]
          },
          { 
            dim: 'informationNeed', 
            question: 'Before deciding, you prefer:',
            options: [
              { value: 'Comprehensive', label: 'All available information' },
              { value: 'Sufficient', label: 'Just enough to decide' }
            ]
          }
        ];

        return h('div', { className: "cosmic-bg min-h-screen flex items-center justify-center p-6" },
          h('div', { className: "max-w-3xl w-full cosmic-card rounded-3xl p-12" },
            h('h2', { className: "text-3xl serif mb-4" }, "Discover Your Decision Profile"),
            h('p', { className: "text-gray-400 mb-8" }, "Answer these questions to reveal your archetype."),
            
            h('div', { className: "space-y-8 mb-8" },
              questions.map((q, idx) => 
                h('div', { key: idx, className: "cosmic-card rounded-2xl p-6" },
                  h('p', { className: "text-lg mb-4 font-light" }, q.question),
                  h('div', { className: "space-y-3" },
                    q.options.map((opt, optIdx) =>
                      h('button', {
                        key: optIdx,
                        onClick: () => setUserData({ ...userData, [q.dim]: opt.value }),
                        className: `w-full p-4 rounded-xl text-left transition-all ${
                          userData[q.dim] === opt.value 
                            ? 'cosmic-glow bg-purple-500/20 border-2 border-purple-500/50' 
                            : 'cosmic-card border-2 border-transparent hover:border-purple-500/30'
                        }`
                      },
                        h('div', { className: "font-medium mb-1" }, opt.label)
                      )
                    )
                  )
                )
              )
            ),

            h('div', { className: "flex gap-4" },
              h('button', {
                onClick: onBack,
                className: "px-6 py-3 rounded-full cosmic-card hover:cosmic-glow transition-all font-light"
              }, "← Back"),
              h('button', {
                onClick: onNext,
                disabled: !questions.every(q => userData[q.dim]),
                className: "flex-1 px-6 py-3 rounded-full cosmic-card cosmic-glow hover:scale-105 transition-all font-light disabled:opacity-50 disabled:cursor-not-allowed"
              }, "Reveal My Archetype →")
            )
          )
        );
      }

      if (step === 4) {
        const profile = QuadrantSystem.getProfile({
          thinkingStyle: userData.thinkingStyle,
          decisionSpeed: userData.decisionSpeed,
          riskTolerance: userData.riskTolerance,
          informationNeed: userData.informationNeed
        });

        return h('div', { className: "cosmic-bg min-h-screen flex items-center justify-center p-6" },
          h('div', { className: "max-w-3xl w-full cosmic-card rounded-3xl p-12" },
            h('div', { className: "text-center mb-8" },
              h('div', { className: "text-xs uppercase tracking-widest text-purple-400 mb-4" }, "Your Archetype"),
              h('h2', { className: "text-4xl serif mb-4 gradient-text" }, profile.title),
              h('p', { className: "text-xl text-gray-400 font-light" }, profile.description)
            ),

            h('div', { className: "cosmic-divider mb-8" }),

            h('div', { className: "grid grid-cols-2 md:grid-cols-4 gap-4 mb-8" },
              h('div', { className: "cosmic-card rounded-xl p-4 text-center" },
                h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Thinking"),
                h('div', { className: "text-purple-300 font-light" }, profile.dimensions.thinkingStyle)
              ),
              h('div', { className: "cosmic-card rounded-xl p-4 text-center" },
                h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Speed"),
                h('div', { className: "text-purple-300 font-light" }, profile.dimensions.decisionSpeed)
              ),
              h('div', { className: "cosmic-card rounded-xl p-4 text-center" },
                h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Risk"),
                h('div', { className: "text-purple-300 font-light" }, profile.dimensions.riskTolerance)
              ),
              h('div', { className: "cosmic-card rounded-xl p-4 text-center" },
                h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Info Need"),
                h('div', { className: "text-purple-300 font-light" }, profile.dimensions.informationNeed)
              )
            ),

            h('div', { className: "cosmic-divider mb-8" }),

            h('div', { className: "space-y-6 mb-8" },
              h('div', null,
                h('div', { className: "text-xs uppercase tracking-widest text-gray-500 mb-3" }, "Your Strengths"),
                h('div', { className: "flex flex-wrap gap-2" },
                  profile.strengths.map((s, i) =>
                    h('span', { 
                      key: i, 
                      className: "px-3 py-1.5 rounded-full text-xs font-light border border-green-500/30 text-green-300"
                    }, s)
                  )
                )
              ),
              h('div', null,
                h('div', { className: "text-xs uppercase tracking-widest text-gray-500 mb-3" }, "Watch Out For"),
                h('div', { className: "flex flex-wrap gap-2" },
                  profile.blindSpots.map((s, i) =>
                    h('span', { 
                      key: i, 
                      className: "px-3 py-1.5 rounded-full text-xs font-light border border-red-500/30 text-red-300"
                    }, s)
                  )
                )
              )
            ),

            h('button', {
              onClick: onNext,
              className: "w-full px-6 py-4 rounded-full cosmic-card cosmic-glow hover:scale-105 transition-all font-light"
            }, "Enter Dashboard →")
          )
        );
      }

      return null;
    };

    // ==================== DECISION FORM ====================
    const DecisionForm = ({ onClose, onSubmit, editingDecision }) => {
      const [formData, setFormData] = useState(editingDecision || {
        domain: 'Financial',
        description: '',
        prediction: '',
        confidence: 50,
        stakes: 'Medium',
        timeframe: '1 month',
        reasoning: '',
        alternatives: ''
      });

      const domains = ['Financial', 'Career', 'Relationships', 'Health', 'Business', 'Personal'];
      const stakes = ['Low', 'Medium', 'High', 'Critical'];
      const timeframes = ['1 week', '1 month', '3 months', '6 months', '1 year', '2+ years'];

      return h('div', { className: "fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 z-50" },
        h('div', { className: "max-w-3xl w-full cosmic-card rounded-3xl p-8 max-h-[90vh] overflow-y-auto" },
          h('div', { className: "flex justify-between items-center mb-6" },
            h('h2', { className: "text-2xl serif" }, editingDecision ? 'Edit Decision' : 'Log New Decision'),
            h('button', { onClick: onClose, className: "hover:text-purple-400 transition-colors" },
              h(X, { className: "w-6 h-6" })
            )
          ),

          h('div', { className: "space-y-6" },
            h('div', null,
              h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "Domain"),
              h('div', { className: "grid grid-cols-3 gap-3" },
                domains.map(d =>
                  h('button', {
                    key: d,
                    onClick: () => setFormData({ ...formData, domain: d }),
                    className: `p-3 rounded-xl text-sm transition-all ${
                      formData.domain === d 
                        ? 'cosmic-glow bg-purple-500/20 border-2 border-purple-500/50' 
                        : 'cosmic-card border-2 border-transparent hover:border-purple-500/30'
                    }`
                  }, d)
                )
              )
            ),

            h('div', null,
              h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "What are you deciding?"),
              h('textarea', {
                value: formData.description,
                onChange: (e) => setFormData({ ...formData, description: e.target.value }),
                className: "w-full px-4 py-3 rounded-xl cosmic-card border-none focus:cosmic-glow focus:outline-none resize-none",
                rows: 2,
                placeholder: "e.g., Should I invest in Bitcoin?"
              })
            ),

            h('div', null,
              h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "Your prediction"),
              h('textarea', {
                value: formData.prediction,
                onChange: (e) => setFormData({ ...formData, prediction: e.target.value }),
                className: "w-full px-4 py-3 rounded-xl cosmic-card border-none focus:cosmic-glow focus:outline-none resize-none",
                rows: 2,
                placeholder: "e.g., I believe Bitcoin will increase 20% in the next 3 months"
              })
            ),

            h('div', null,
              h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, 
                `Confidence: ${formData.confidence}%`
              ),
              h('input', {
                type: "range",
                min: "0",
                max: "100",
                value: formData.confidence,
                onChange: (e) => setFormData({ ...formData, confidence: parseInt(e.target.value) }),
                className: "slider w-full"
              })
            ),

            h('div', { className: "grid grid-cols-2 gap-6" },
              h('div', null,
                h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "Stakes"),
                h('div', { className: "grid grid-cols-2 gap-2" },
                  stakes.map(s =>
                    h('button', {
                      key: s,
                      onClick: () => setFormData({ ...formData, stakes: s }),
                      className: `p-2 rounded-xl text-sm transition-all ${
                        formData.stakes === s 
                          ? 'cosmic-glow bg-purple-500/20 border-2 border-purple-500/50' 
                          : 'cosmic-card border-2 border-transparent hover:border-purple-500/30'
                      }`
                    }, s)
                  )
                )
              ),

              h('div', null,
                h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "Timeframe"),
                h('select', {
                  value: formData.timeframe,
                  onChange: (e) => setFormData({ ...formData, timeframe: e.target.value }),
                  className: "w-full px-4 py-2 rounded-xl cosmic-card border-none focus:cosmic-glow focus:outline-none"
                },
                  timeframes.map(t => h('option', { key: t, value: t }, t))
                )
              )
            ),

            h('div', null,
              h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "Reasoning (Optional)"),
              h('textarea', {
                value: formData.reasoning,
                onChange: (e) => setFormData({ ...formData, reasoning: e.target.value }),
                className: "w-full px-4 py-3 rounded-xl cosmic-card border-none focus:cosmic-glow focus:outline-none resize-none",
                rows: 3,
                placeholder: "Why do you believe this?"
              })
            ),

            h('div', null,
              h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "Alternatives Considered (Optional)"),
              h('textarea', {
                value: formData.alternatives,
                onChange: (e) => setFormData({ ...formData, alternatives: e.target.value }),
                className: "w-full px-4 py-3 rounded-xl cosmic-card border-none focus:cosmic-glow focus:outline-none resize-none",
                rows: 2,
                placeholder: "What other options did you consider?"
              })
            )
          ),

          h('div', { className: "flex gap-4 mt-8" },
            h('button', {
              onClick: onClose,
              className: "flex-1 px-6 py-3 rounded-full cosmic-card hover:cosmic-glow transition-all font-light"
            }, "Cancel"),
            h('button', {
              onClick: () => {
                if (formData.description && formData.prediction) {
                  onSubmit({ ...formData, id: editingDecision?.id || Date.now(), timestamp: editingDecision?.timestamp || new Date().toISOString() });
                  onClose();
                }
              },
              disabled: !formData.description || !formData.prediction,
              className: "flex-1 px-6 py-3 rounded-full cosmic-card cosmic-glow hover:scale-105 transition-all font-light disabled:opacity-50"
            }, editingDecision ? 'Update Decision' : 'Log Decision')
          )
        )
      );
    };

    // ==================== OUTCOME FORM ====================
    const OutcomeForm = ({ decision, onClose, onSubmit }) => {
      const [outcome, setOutcome] = useState({
        result: '',
        accuracy: 'Correct',
        attribution: 'Skill',
        surprise: 3,
        learnings: ''
      });

      const accuracyOptions = ['Correct', 'Partially Correct', 'Wrong'];
      const attributionOptions = ['Skill', 'Luck', 'External Factors', 'Mixed'];

      return h('div', { className: "fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 z-50" },
        h('div', { className: "max-w-3xl w-full cosmic-card rounded-3xl p-8 max-h-[90vh] overflow-y-auto" },
          h('div', { className: "flex justify-between items-center mb-6" },
            h('h2', { className: "text-2xl serif" }, 'Log Outcome'),
            h('button', { onClick: onClose, className: "hover:text-purple-400 transition-colors" },
              h(X, { className: "w-6 h-6" })
            )
          ),

          h('div', { className: "cosmic-card rounded-2xl p-6 mb-6" },
            h('div', { className: "text-xs uppercase tracking-widest text-purple-400 mb-2" }, "Original Decision"),
            h('p', { className: "text-lg font-light mb-2" }, decision.description),
            h('p', { className: "text-gray-400 text-sm" }, `Prediction: ${decision.prediction}`),
            h('p', { className: "text-gray-400 text-sm" }, `Confidence: ${decision.confidence}%`)
          ),

          h('div', { className: "space-y-6" },
            h('div', null,
              h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "What actually happened?"),
              h('textarea', {
                value: outcome.result,
                onChange: (e) => setOutcome({ ...outcome, result: e.target.value }),
                className: "w-full px-4 py-3 rounded-xl cosmic-card border-none focus:cosmic-glow focus:outline-none resize-none",
                rows: 3,
                placeholder: "Describe the actual outcome..."
              })
            ),

            h('div', null,
              h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "Was your prediction accurate?"),
              h('div', { className: "grid grid-cols-3 gap-3" },
                accuracyOptions.map(a =>
                  h('button', {
                    key: a,
                    onClick: () => setOutcome({ ...outcome, accuracy: a }),
                    className: `p-3 rounded-xl text-sm transition-all ${
                      outcome.accuracy === a 
                        ? 'cosmic-glow bg-purple-500/20 border-2 border-purple-500/50' 
                        : 'cosmic-card border-2 border-transparent hover:border-purple-500/30'
                    }`
                  }, a)
                )
              )
            ),

            h('div', null,
              h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, 
                "What contributed to this outcome?"
              ),
              h('div', { className: "grid grid-cols-2 gap-3" },
                attributionOptions.map(a =>
                  h('button', {
                    key: a,
                    onClick: () => setOutcome({ ...outcome, attribution: a }),
                    className: `p-3 rounded-xl text-sm transition-all ${
                      outcome.attribution === a 
                        ? 'cosmic-glow bg-purple-500/20 border-2 border-purple-500/50' 
                        : 'cosmic-card border-2 border-transparent hover:border-purple-500/30'
                    }`
                  }, a)
                )
              )
            ),

            h('div', null,
              h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, 
                `Surprise Level: ${outcome.surprise}/5`
              ),
              h('input', {
                type: "range",
                min: "1",
                max: "5",
                value: outcome.surprise,
                onChange: (e) => setOutcome({ ...outcome, surprise: parseInt(e.target.value) }),
                className: "slider w-full"
              }),
              h('div', { className: "flex justify-between text-xs text-gray-500 mt-2" },
                h('span', null, "Expected"),
                h('span', null, "Very Surprising")
              )
            ),

            h('div', null,
              h('label', { className: "block text-sm text-gray-500 mb-2 uppercase tracking-wider" }, "Key Learnings (Optional)"),
              h('textarea', {
                value: outcome.learnings,
                onChange: (e) => setOutcome({ ...outcome, learnings: e.target.value }),
                className: "w-full px-4 py-3 rounded-xl cosmic-card border-none focus:cosmic-glow focus:outline-none resize-none",
                rows: 3,
                placeholder: "What did you learn from this?"
              })
            )
          ),

          h('div', { className: "flex gap-4 mt-8" },
            h('button', {
              onClick: onClose,
              className: "flex-1 px-6 py-3 rounded-full cosmic-card hover:cosmic-glow transition-all font-light"
            }, "Cancel"),
            h('button', {
              onClick: () => {
                if (outcome.result) {
                  onSubmit(outcome);
                  onClose();
                }
              },
              disabled: !outcome.result,
              className: "flex-1 px-6 py-3 rounded-full cosmic-card cosmic-glow hover:scale-105 transition-all font-light disabled:opacity-50"
            }, 'Submit Outcome')
          )
        )
      );
    };

    // ==================== ANALYTICS/CHARTS VIEW ====================
    const AnalyticsView = ({ userData, onClose, onUnlock }) => {
      const hasSubscription = userData.hasSubscription;

      if (!hasSubscription) {
        return h('div', { className: "fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 z-50" },
          h('div', { className: "max-w-2xl w-full cosmic-card rounded-3xl p-12 text-center" },
            h('div', { className: "mb-8" },
              h(Lock, { className: "w-20 h-20 mx-auto text-purple-400 animate-float" })
            ),
            h('h2', { className: "text-3xl serif mb-4" }, "Advanced Analytics"),
            h('p', { className: "text-xl text-gray-400 mb-8" }, 
              "Unlock deep insights into your decision patterns with calibration curves, domain breakdowns, and predictive analytics."
            ),

            h('div', { className: "cosmic-card rounded-2xl p-8 mb-8" },
              h('div', { className: "text-4xl serif mb-4 gradient-text" }, "$29/month"),
              h('p', { className: "text-gray-400 mb-6" }, "Or $290/year (save $58)"),
              h('ul', { className: "text-left space-y-3 mb-6" },
                ['Calibration curves & accuracy tracking', 'Domain-specific analytics', 'Confidence vs. accuracy plots', 'Blind spot detection', 'Historical trend analysis', 'Export reports'].map((feature, i) =>
                  h('li', { key: i, className: "flex items-start gap-3" },
                    h('svg', { className: "w-5 h-5 text-green-400 mt-0.5 flex-shrink-0", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
                      h('path', { d: "M5 13l4 4L19 7" })
                    ),
                    h('span', { className: "text-gray-300 font-light" }, feature)
                  )
                )
              )
            ),

            h('div', { className: "flex gap-4" },
              h('button', {
                onClick: onClose,
                className: "flex-1 px-6 py-3 rounded-full cosmic-card hover:cosmic-glow transition-all font-light"
              }, "Maybe Later"),
              h('button', {
                onClick: onUnlock,
                className: "flex-1 px-6 py-3 rounded-full cosmic-card cosmic-glow hover:scale-105 transition-all font-light"
              }, "Unlock Analytics →")
            )
          )
        );
      }

      // If subscribed, show analytics
      const decisions = userData.decisions || [];
      const resolvedDecisions = decisions.filter(d => d.outcome);
      
      const domainStats = {};
      resolvedDecisions.forEach(d => {
        if (!domainStats[d.domain]) {
          domainStats[d.domain] = { correct: 0, total: 0 };
        }
        domainStats[d.domain].total++;
        if (d.outcome.accuracy === 'Correct') {
          domainStats[d.domain].correct++;
        }
      });

      return h('div', { className: "fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 z-50" },
        h('div', { className: "max-w-6xl w-full cosmic-card rounded-3xl p-8 max-h-[90vh] overflow-y-auto" },
          h('div', { className: "flex justify-between items-center mb-8" },
            h('h2', { className: "text-3xl serif" }, 'Decision Analytics'),
            h('button', { onClick: onClose, className: "hover:text-purple-400 transition-colors" },
              h(X, { className: "w-6 h-6" })
            )
          ),

          resolvedDecisions.length === 0 ? 
            h('div', { className: "text-center py-12" },
              h('p', { className: "text-gray-400 text-lg" }, "No resolved decisions yet. Log some decisions and outcomes to see your analytics.")
            )
          :
          h('div', { className: "space-y-8" },
            h('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-6" },
              h('div', { className: "cosmic-card rounded-2xl p-6" },
                h('div', { className: "text-sm text-gray-500 uppercase tracking-wider mb-2" }, "Total Decisions"),
                h('div', { className: "text-4xl serif gradient-text" }, resolvedDecisions.length)
              ),
              h('div', { className: "cosmic-card rounded-2xl p-6" },
                h('div', { className: "text-sm text-gray-500 uppercase tracking-wider mb-2" }, "Overall Accuracy"),
                h('div', { className: "text-4xl serif text-green-400" }, 
                  `${Math.round((resolvedDecisions.filter(d => d.outcome.accuracy === 'Correct').length / resolvedDecisions.length) * 100)}%`
                )
              ),
              h('div', { className: "cosmic-card rounded-2xl p-6" },
                h('div', { className: "text-sm text-gray-500 uppercase tracking-wider mb-2" }, "Avg Confidence"),
                h('div', { className: "text-4xl serif text-blue-400" }, 
                  `${Math.round(resolvedDecisions.reduce((sum, d) => sum + d.confidence, 0) / resolvedDecisions.length)}%`
                )
              )
            ),

            h('div', { className: "cosmic-card rounded-2xl p-8" },
              h('h3', { className: "text-xl serif mb-6" }, "Accuracy by Domain"),
              h('div', { className: "space-y-4" },
                Object.entries(domainStats).map(([domain, stats]) => {
                  const accuracy = Math.round((stats.correct / stats.total) * 100);
                  return h('div', { key: domain },
                    h('div', { className: "flex justify-between items-center mb-2" },
                      h('span', { className: "font-light" }, domain),
                      h('span', { className: "text-sm text-gray-400" }, `${stats.correct}/${stats.total} (${accuracy}%)`)
                    ),
                    h('div', { className: "w-full h-3 rounded-full bg-gray-800 overflow-hidden" },
                      h('div', { 
                        className: "h-full rounded-full bg-gradient-to-r from-purple-500 to-blue-500",
                        style: { width: `${accuracy}%` }
                      })
                    )
                  );
                })
              )
            ),

            h('div', { className: "cosmic-card rounded-2xl p-8" },
              h('h3', { className: "text-xl serif mb-4" }, "Recent Decisions"),
              h('div', { className: "space-y-4" },
                resolvedDecisions.slice(-5).reverse().map((d, i) =>
                  h('div', { key: i, className: "cosmic-card rounded-xl p-4" },
                    h('div', { className: "flex justify-between items-start mb-2" },
                      h('div', null,
                        h('span', { className: "text-xs uppercase tracking-wider text-purple-400" }, d.domain),
                        h('p', { className: "font-light mt-1" }, d.description)
                      ),
                      h('span', { 
                        className: `text-xs px-2 py-1 rounded-full ${
                          d.outcome.accuracy === 'Correct' ? 'bg-green-500/20 text-green-300' :
                          d.outcome.accuracy === 'Partially Correct' ? 'bg-yellow-500/20 text-yellow-300' :
                          'bg-red-500/20 text-red-300'
                        }`
                      }, d.outcome.accuracy)
                    ),
                    h('p', { className: "text-sm text-gray-400" }, `Confidence: ${d.confidence}%`)
                  )
                )
              )
            )
          )
        )
      );
    };

    // ==================== DECISION ASSISTANT ====================
    const DecisionAssistant = ({ userData, setUserData, onClose }) => {
      const [messages, setMessages] = useState([
        { role: 'assistant', content: `Hello ${userData.name}! I'm your decision intelligence oracle. I can help you analyze your patterns, calibrate your confidence, and improve your judgment. What would you like to explore?` }
      ]);
      const [input, setInput] = useState('');
      const messagesEndRef = useRef(null);

      useEffect(() => {
        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
      }, [messages]);

      const handleSend = () => {
        if (!input.trim()) return;

        const userMessage = { role: 'user', content: input };
        setMessages([...messages, userMessage]);
        setInput('');

        setTimeout(() => {
          const assistantMessage = { 
            role: 'assistant', 
            content: generateResponse(input, userData) 
          };
          setMessages(prev => [...prev, assistantMessage]);
        }, 1000);
      };

      const generateResponse = (query, data) => {
        const q = query.toLowerCase();
        
        if (q.includes('pattern') || q.includes('trend')) {
          const decisions = data.decisions || [];
          const resolved = decisions.filter(d => d.outcome);
          if (resolved.length === 0) return "You haven't resolved any decisions yet. Log some outcomes so I can identify your patterns!";
          
          const accuracy = Math.round((resolved.filter(d => d.outcome.accuracy === 'Correct').length / resolved.length) * 100);
          return `Based on ${resolved.length} resolved decisions, your overall accuracy is ${accuracy}%. I notice you tend to be ${data.riskTolerance} and ${data.decisionSpeed} in your approach. This aligns with your ${data.profile?.title} archetype.`;
        }
        
        if (q.includes('improve') || q.includes('better')) {
          return `As a ${data.profile?.title}, I recommend: (1) Track your confidence levels more carefully, (2) Review decisions after 1-3 months to calibrate, (3) Watch out for your blind spots: ${data.profile?.blindSpots?.join(', ')}. Your strength lies in ${data.profile?.strengths?.[0] || 'your unique approach'}.`;
        }
        
        if (q.includes('confidence') || q.includes('calibrat')) {
          return "Calibration is about aligning your confidence with actual outcomes. Log more decisions with confidence levels, then compare them to results. Most people are overconfident in the 60-80% range. Try to be brutally honest about uncertainty.";
        }
        
        return "Interesting question! I can help you with: understanding your decision patterns, calibrating confidence, identifying blind spots, or analyzing specific domains. What would you like to explore?";
      };

      return h('div', { className: "fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-6 z-50" },
        h('div', { className: "max-w-3xl w-full cosmic-card rounded-3xl p-8 flex flex-col h-[600px]" },
          h('div', { className: "flex justify-between items-center mb-6" },
            h('div', { className: "flex items-center gap-3" },
              h(Sparkles, { className: "w-6 h-6 text-purple-400 animate-float" }),
              h('h2', { className: "text-2xl serif" }, 'Oracle')
            ),
            h('button', { onClick: onClose, className: "hover:text-purple-400 transition-colors" },
              h(X, { className: "w-6 h-6" })
            )
          ),

          h('div', { className: "flex-1 overflow-y-auto mb-6 space-y-4" },
            messages.map((msg, i) =>
              h('div', {
                key: i,
                className: `message-bubble ${msg.role === 'user' ? 'ml-8' : 'mr-8'}`
              },
                h('div', {
                  className: `p-4 rounded-2xl ${
                    msg.role === 'user' 
                      ? 'bg-purple-500/20 ml-auto' 
                      : 'cosmic-card'
                  }`
                },
                  h('p', { className: "font-light leading-relaxed" }, msg.content)
                )
              )
            ),
            h('div', { ref: messagesEndRef })
          ),

          h('div', { className: "flex gap-3" },
            h('input', {
              type: "text",
              value: input,
              onChange: (e) => setInput(e.target.value),
              onKeyPress: (e) => e.key === 'Enter' && handleSend(),
              placeholder: "Ask the oracle...",
              className: "flex-1 px-4 py-3 rounded-xl cosmic-card border-none focus:cosmic-glow focus:outline-none"
            }),
            h('button', {
              onClick: handleSend,
              className: "px-6 py-3 rounded-xl cosmic-card cosmic-glow hover:scale-105 transition-all"
            },
              h(Send, { className: "w-5 h-5" })
            )
          )
        )
      );
    };

    // ==================== MAIN APP ====================
    const Calibrate = () => {
      const [userData, setUserData] = useState(() => {
        const saved = localStorage.getItem('calibrateData');
        return saved ? JSON.parse(saved) : { decisions: [] };
      });

      const [onboardingStep, setOnboardingStep] = useState(() => {
        return userData.name ? 0 : 1;
      });

      const [showDecisionForm, setShowDecisionForm] = useState(false);
      const [showOutcomeForm, setShowOutcomeForm] = useState(null);
      const [showAnalytics, setShowAnalytics] = useState(false);
      const [showAssistant, setShowAssistant] = useState(false);

      useEffect(() => {
        localStorage.setItem('calibrateData', JSON.stringify(userData));
      }, [userData]);

      const handleOnboardingNext = () => {
        if (onboardingStep === 4) {
          const profile = QuadrantSystem.getProfile({
            thinkingStyle: userData.thinkingStyle,
            decisionSpeed: userData.decisionSpeed,
            riskTolerance: userData.riskTolerance,
            informationNeed: userData.informationNeed
          });
          setUserData({ ...userData, profile });
          setOnboardingStep(0);
        } else {
          setOnboardingStep(onboardingStep + 1);
        }
      };

      const handleDecisionSubmit = (decision) => {
        const decisions = userData.decisions || [];
        const existingIndex = decisions.findIndex(d => d.id === decision.id);
        
        if (existingIndex >= 0) {
          decisions[existingIndex] = decision;
        } else {
          decisions.push(decision);
        }
        
        setUserData({ ...userData, decisions });
      };

      const handleOutcomeSubmit = (outcome) => {
        const decisions = userData.decisions.map(d => 
          d.id === showOutcomeForm.id ? { ...d, outcome } : d
        );
        setUserData({ ...userData, decisions });
      };

      const handleReset = () => {
        if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
          localStorage.removeItem('calibrateData');
          window.location.reload();
        }
      };

      const handleUnlockAnalytics = () => {
        setUserData({ ...userData, hasSubscription: true });
        alert('Analytics unlocked! (Demo mode - no actual payment processed)');
      };

      if (onboardingStep > 0) {
        return h(OnboardingScreen, {
          step: onboardingStep,
          onNext: handleOnboardingNext,
          onBack: () => setOnboardingStep(Math.max(1, onboardingStep - 1)),
          userData,
          setUserData
        });
      }

      const profile = userData.profile;
      const decisions = userData.decisions || [];
      const pendingDecisions = decisions.filter(d => !d.outcome);
      const resolvedDecisions = decisions.filter(d => d.outcome);

      const domainAccuracy = {};
      resolvedDecisions.forEach(d => {
        if (!domainAccuracy[d.domain]) {
          domainAccuracy[d.domain] = { correct: 0, total: 0 };
        }
        domainAccuracy[d.domain].total++;
        if (d.outcome.accuracy === 'Correct') {
          domainAccuracy[d.domain].correct++;
        }
      });

      return h('div', { className: "cosmic-bg min-h-screen" },
        h('div', { className: "max-w-7xl mx-auto p-6" },
          // Header
          h('div', { className: "flex justify-between items-center mb-8" },
            h('div', null,
              h('h1', { className: "text-4xl serif mb-2 gradient-text" }, `Welcome back, ${userData.name}`),
              h('p', { className: "text-gray-400 font-light" }, profile?.title || 'Decision Intelligence System')
            ),
            h('button', {
              onClick: handleReset,
              className: "px-4 py-2 rounded-full cosmic-card hover:cosmic-glow transition-all font-light text-sm flex items-center gap-2"
            },
              h(RefreshCw, { className: "w-4 h-4" }),
              'Reset'
            )
          ),

          // Stats Overview
          h('div', { className: "grid grid-cols-1 md:grid-cols-4 gap-6 mb-8" },
            h('div', { className: "stat-orb rounded-3xl p-6" },
              h('div', { className: "text-sm text-gray-400 uppercase tracking-wider mb-2" }, "Tracked"),
              h('div', { className: "text-4xl serif" }, decisions.length)
            ),
            h('div', { className: "stat-orb rounded-3xl p-6" },
              h('div', { className: "text-sm text-gray-400 uppercase tracking-wider mb-2" }, "Pending"),
              h('div', { className: "text-4xl serif text-yellow-400" }, pendingDecisions.length)
            ),
            h('div', { className: "stat-orb rounded-3xl p-6" },
              h('div', { className: "text-sm text-gray-400 uppercase tracking-wider mb-2" }, "Resolved"),
              h('div', { className: "text-4xl serif text-green-400" }, resolvedDecisions.length)
            ),
            h('div', { className: "stat-orb rounded-3xl p-6" },
              h('div', { className: "text-sm text-gray-400 uppercase tracking-wider mb-2" }, "Accuracy"),
              h('div', { className: "text-4xl serif text-purple-400" }, 
                resolvedDecisions.length > 0 
                  ? `${Math.round((resolvedDecisions.filter(d => d.outcome.accuracy === 'Correct').length / resolvedDecisions.length) * 100)}%`
                  : '--'
              )
            )
          ),

          // Profile Card
          profile && h('div', { className: "cosmic-card rounded-3xl p-8 mb-8" },
            h('div', { className: "text-xs uppercase tracking-widest text-purple-400 mb-4 font-light" }, "Your Archetype"),
            h('h3', { className: "text-3xl serif mb-3" }, profile.title),
            h('p', { className: "text-gray-400 mb-6 font-light leading-relaxed" }, profile.description),
            
            h('div', { className: "cosmic-divider mb-6" }),
            
            h('div', { className: "grid grid-cols-2 md:grid-cols-4 gap-4 mb-6" },
              h('div', null,
                h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Thinking"),
                h('div', { className: "text-purple-300 font-light" }, profile.dimensions.thinkingStyle)
              ),
              h('div', null,
                h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Speed"),
                h('div', { className: "text-purple-300 font-light" }, profile.dimensions.decisionSpeed)
              ),
              h('div', null,
                h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Risk"),
                h('div', { className: "text-purple-300 font-light" }, profile.dimensions.riskTolerance)
              ),
              h('div', null,
                h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Info Need"),
                h('div', { className: "text-purple-300 font-light" }, profile.dimensions.informationNeed)
              )
            ),
            
            h('div', { className: "cosmic-divider mb-6" }),
            
            h('div', null,
              h('div', { className: "text-xs uppercase tracking-widest text-gray-500 mb-3" }, "Strengths"),
              h('div', { className: "flex flex-wrap gap-2 mb-6" },
                profile.strengths.map((strength, i) =>
                  h('span', { 
                    key: i, 
                    className: "px-3 py-1.5 rounded-full text-xs font-light border border-green-500/30 text-green-300"
                  }, strength)
                )
              ),
              h('div', { className: "text-xs uppercase tracking-widest text-gray-500 mb-3" }, "Blind Spots"),
              h('div', { className: "flex flex-wrap gap-2" },
                profile.blindSpots.map((spot, i) =>
                  h('span', { 
                    key: i, 
                    className: "px-3 py-1.5 rounded-full text-xs font-light border border-red-500/30 text-red-300"
                  }, spot)
                )
              )
            )
          ),

          // Pending Decisions
          pendingDecisions.length > 0 && h('div', { className: "cosmic-card rounded-3xl p-8 mb-8" },
            h('h3', { className: "text-xl serif mb-6" }, "Pending Outcomes"),
            h('div', { className: "space-y-4" },
              pendingDecisions.map((d, i) =>
                h('div', { key: i, className: "cosmic-card rounded-2xl p-6 hover:cosmic-glow transition-all" },
                  h('div', { className: "flex justify-between items-start mb-3" },
                    h('div', null,
                      h('span', { className: "text-xs uppercase tracking-wider text-purple-400" }, d.domain),
                      h('p', { className: "text-lg font-light mt-1" }, d.description)
                    ),
                    h('button', {
                      onClick: () => setShowOutcomeForm(d),
                      className: "px-4 py-2 rounded-full cosmic-card hover:cosmic-glow transition-all text-sm font-light"
                    }, "Log Outcome")
                  ),
                  h('p', { className: "text-sm text-gray-400 mb-2" }, `Prediction: ${d.prediction}`),
                  h('div', { className: "flex gap-4 text-xs text-gray-500" },
                    h('span', null, `Confidence: ${d.confidence}%`),
                    h('span', null, `Stakes: ${d.stakes}`),
                    h('span', null, `Timeframe: ${d.timeframe}`)
                  )
                )
              )
            )
          ),

          // Action Cards
          h('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-6" },
            h('button', { 
              onClick: () => setShowDecisionForm(true),
              className: "cosmic-card rounded-3xl p-8 hover:cosmic-glow transition-all text-left group"
            },
              h('div', { className: "mb-6 opacity-60 group-hover:opacity-100 transition-opacity" },
                h(Plus, { className: "w-10 h-10 text-purple-400" })
              ),
              h('h3', { className: "text-xl serif mb-2" }, "Log Decision"),
              h('p', { className: "text-sm text-gray-500 font-light" }, "Record a new prediction")
            ),

            h('button', { 
              onClick: () => setShowAnalytics(true),
              className: "cosmic-card rounded-3xl p-8 hover:cosmic-glow transition-all text-left group"
            },
              h('div', { className: "mb-6 opacity-60 group-hover:opacity-100 transition-opacity" },
                h(BarChart, { className: "w-10 h-10 text-blue-400" })
              ),
              h('h3', { className: "text-xl serif mb-2" }, "View Analytics"),
              h('p', { className: "text-sm text-gray-500 font-light" }, "Explore your patterns"),
              !userData.hasSubscription && h('div', { className: "mt-3 flex items-center gap-2 text-xs text-yellow-400" },
                h(Lock, { className: "w-4 h-4" }),
                'Premium'
              )
            ),

            h('button', { 
              onClick: () => setShowAssistant(true),
              className: "cosmic-card rounded-3xl p-8 cosmic-glow text-left group relative overflow-hidden"
            },
              h('div', { 
                className: "absolute inset-0 bg-gradient-to-br from-purple-600/20 to-blue-600/20 opacity-0 group-hover:opacity-100 transition-opacity"
              }),
              h('div', { className: "relative" },
                h('div', { className: "mb-6 animate-float" },
                  h(Sparkles, { className: "w-10 h-10 text-purple-300" })
                ),
                h('h3', { className: "text-xl serif mb-2" }, "Oracle"),
                h('p', { className: "text-sm text-gray-500 font-light" }, "Receive guidance")
              )
            )
          )
        ),

        // Modals
        showDecisionForm && h(DecisionForm, {
          onClose: () => setShowDecisionForm(false),
          onSubmit: handleDecisionSubmit
        }),

        showOutcomeForm && h(OutcomeForm, {
          decision: showOutcomeForm,
          onClose: () => setShowOutcomeForm(null),
          onSubmit: handleOutcomeSubmit
        }),

        showAnalytics && h(AnalyticsView, {
          userData,
          onClose: () => setShowAnalytics(false),
          onUnlock: handleUnlockAnalytics
        }),

        showAssistant && h(DecisionAssistant, {
          userData,
          setUserData,
          onClose: () => setShowAssistant(false)
        })
      );
    };

    // ==================== RENDER ====================
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(h(Calibrate));
</script>

</body>
</html>