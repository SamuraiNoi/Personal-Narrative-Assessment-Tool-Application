<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calibrate - Decision Intelligence System</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        body { 
            margin: 0; 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
        }
        .serif { font-family: 'DM Serif Display', serif; }
        .cosmic-bg {
            background: radial-gradient(ellipse at top, #1a1a2e 0%, #0a0a0a 50%);
        }
        .cosmic-card {
            background: rgba(20, 20, 30, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .cosmic-glow {
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.3);
        }
        .stat-orb {
            background: radial-gradient(circle at 30% 30%, rgba(139, 92, 246, 0.3), rgba(59, 130, 246, 0.2));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        .gradient-text {
            background: linear-gradient(135deg, #a78bfa 0%, #60a5fa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .cosmic-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.5), transparent);
        }
        .message-bubble {
            animation: fadeInUp 0.4s ease-out;
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        input::placeholder, textarea::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }
        .constellation-dot {
            width: 2px;
            height: 2px;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            position: absolute;
            animation: twinkle 3s ease-in-out infinite;
        }
        @keyframes twinkle {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

```
<script>
    const { createElement: h, useState, useEffect, useRef, useMemo, Fragment } = React;

    // Icons as minimal SVG components
    const Brain = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('circle', { cx: "12", cy: "12", r: "10", opacity: "0.3" }),
        h('path', { d: "M12 2a10 10 0 0 1 0 20" }),
        h('circle', { cx: "12", cy: "12", r: "3", fill: "currentColor" })
    );

    const Sparkles = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" }),
        h('path', { d: "M5 3v4", opacity: "0.5" }),
        h('path', { d: "M19 17v4", opacity: "0.5" }),
        h('path', { d: "M3 5h4", opacity: "0.5" }),
        h('path', { d: "M17 19h4", opacity: "0.5" })
    );

    const Send = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z" }),
        h('path', { d: "m21.854 2.147-10.94 10.939" })
    );

    const X = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "M18 6 6 18" }),
        h('path', { d: "m6 6 12 12" })
    );

    const Search = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('circle', { cx: "11", cy: "11", r: "8" }),
        h('path', { d: "m21 21-4.3-4.3" })
    );

    const Eye = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z" }),
        h('circle', { cx: "12", cy: "12", r: "3" })
    );

    const Moon = (props) => h('svg', { xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "1.5", strokeLinecap: "round", strokeLinejoin: "round", ...props },
        h('path', { d: "M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" })
    );

    // ==================== QUADRANT SYSTEM ====================
    const QuadrantSystem = {
      dimensions: {
        thinkingStyle: ['Analytical', 'Intuitive'],
        decisionSpeed: ['Deliberate', 'Rapid'],
        riskTolerance: ['Conservative', 'Bold'],
        informationNeed: ['Comprehensive', 'Sufficient']
      },

      types: {
        'Analytical-Deliberate-Conservative-Comprehensive': { title: 'Strategic Architect', description: 'Methodical planner who excels at complex analysis', strengths: ['Risk assessment', 'Long-term planning', 'Detail orientation'], blindSpots: ['Analysis paralysis', 'Missed opportunities', 'Slow in crisis'], teamValue: 'Prevents costly mistakes through thorough evaluation' },
        'Analytical-Deliberate-Bold-Comprehensive': { title: 'Calculated Innovator', description: 'Data-driven risk-taker who bets on analyzed opportunities', strengths: ['Informed risk-taking', 'Strategic disruption', 'Evidence-based boldness'], blindSpots: ['Overconfidence in models', 'Slow to pivot', 'Data blind spots'], teamValue: 'Drives innovation with analytical backing' },
        'Analytical-Rapid-Conservative-Comprehensive': { title: 'Efficient Optimizer', description: 'Quick analyst who streamlines without recklessness', strengths: ['Rapid problem-solving', 'Pattern recognition', 'Efficient execution'], blindSpots: ['Premature optimization', 'Missing nuance', 'Burnout risk'], teamValue: 'Accelerates execution while maintaining quality' },
        'Analytical-Rapid-Bold-Comprehensive': { title: 'Decisive Strategist', description: 'Fast, data-informed decision-maker who seizes opportunities', strengths: ['Speed + accuracy', 'Competitive advantage', 'Crisis management'], blindSpots: ['Overcommitment', 'Team overwhelm', 'Sustainability'], teamValue: 'Capitalizes on time-sensitive opportunities' },
        'Intuitive-Deliberate-Conservative-Comprehensive': { title: 'Wise Counselor', description: 'Thoughtful advisor who reads between the lines', strengths: ['Cultural intelligence', 'People reading', 'Long-term relationships'], blindSpots: ['Overthinking signals', 'Risk aversion', 'Slow decisions'], teamValue: 'Identifies human factors others miss' },
        'Intuitive-Deliberate-Bold-Comprehensive': { title: 'Visionary Leader', description: 'Bold thinker who trusts conviction backed by reflection', strengths: ['Vision setting', 'Inspiring others', 'Strategic courage'], blindSpots: ['Confirmation bias', 'Groupthink', 'Execution gaps'], teamValue: 'Sets direction and rallies teams toward ambitious goals' },
        'Intuitive-Rapid-Conservative-Sufficient': { title: 'Agile Adapter', description: 'Flexible responder who reads situations quickly', strengths: ['Adaptability', 'Relationship building', 'Conflict resolution'], blindSpots: ['Indecisiveness', 'Insufficient rigor', 'Boundary issues'], teamValue: 'Maintains team cohesion through change' },
        'Intuitive-Rapid-Bold-Sufficient': { title: 'Dynamic Catalyst', description: 'Instinct-driven mover who acts on gut feel', strengths: ['First-mover advantage', 'Energy creation', 'Breaking inertia'], blindSpots: ['Impulsiveness', 'Overlooking risks', 'Inconsistency'], teamValue: 'Initiates action when others hesitate' },
        'Analytical-Deliberate-Conservative-Sufficient': { title: 'Prudent Operator', description: 'Careful executor who values proven methods', strengths: ['Reliability', 'Quality control', 'Risk management'], blindSpots: ['Rigidity', 'Innovation resistance', 'Opportunity cost'], teamValue: 'Ensures operational excellence and stability' },
        'Analytical-Deliberate-Bold-Sufficient': { title: 'Strategic Disruptor', description: 'Bold analyst who challenges conventions with data', strengths: ['Creative problem-solving', 'Strategic pivots', 'Competitive edge'], blindSpots: ['Overestimating data', 'Change fatigue', 'Execution risk'], teamValue: 'Questions assumptions and finds better ways' },
        'Analytical-Rapid-Conservative-Sufficient': { title: 'Tactical Executor', description: 'Quick implementer who delivers without drama', strengths: ['Execution speed', 'Pragmatism', 'Consistency'], blindSpots: ['Tunnel vision', 'Missing opportunities', 'Burnout'], teamValue: 'Ships reliably and keeps projects moving' },
        'Analytical-Rapid-Bold-Sufficient': { title: 'Entrepreneurial Driver', description: 'Fast-moving builder who trusts quick analysis', strengths: ['Rapid scaling', 'Market timing', 'Momentum building'], blindSpots: ['Technical debt', 'Team strain', 'Unsustainable pace'], teamValue: 'Drives aggressive growth and market capture' },
        'Intuitive-Deliberate-Conservative-Sufficient': { title: 'Empathetic Guardian', description: 'People-first thinker who protects team wellbeing', strengths: ['Team morale', 'Culture building', 'Conflict prevention'], blindSpots: ['Avoiding conflict', 'Slow growth', 'Performance issues'], teamValue: 'Creates psychological safety and retention' },
        'Intuitive-Deliberate-Bold-Sufficient': { title: 'Inspirational Maverick', description: 'Conviction-driven leader who trusts their vision', strengths: ['Charisma', 'Big bets', 'Culture transformation'], blindSpots: ['Reality disconnect', 'Blind loyalty', 'Sustainability'], teamValue: 'Transforms culture and inspires extraordinary effort' },
        'Intuitive-Rapid-Conservative-Comprehensive': { title: 'Diplomatic Navigator', description: 'Quick reader who builds consensus carefully', strengths: ['Stakeholder management', 'Political savvy', 'Harmony'], blindSpots: ['Over-accommodation', 'Decision delay', 'Conflict avoidance'], teamValue: 'Navigates complex organizational dynamics' },
        'Intuitive-Rapid-Bold-Comprehensive': { title: 'Transformative Pioneer', description: 'Bold intuitive who acts on holistic understanding', strengths: ['Change leadership', 'Pattern synthesis', 'Strategic courage'], blindSpots: ['Overextension', 'Unpredictability', 'Team whiplash'], teamValue: 'Leads transformative initiatives others fear' }
      },
      
      assessFromDecisions: (decisions) => {
        if (decisions.length < 5) return null;
        const completed = decisions.filter(d => d.outcome !== null);
        if (completed.length < 3) return null;

        const analyticalDecisions = decisions.filter(d => d.decisionBasis === 'Data/Analysis').length;
        const thinkingStyle = (analyticalDecisions / decisions.length) > 0.5 ? 'Analytical' : 'Intuitive';

        const rapidDecisions = decisions.filter(d => d.timeToDecide === 'instant' || d.timeToDecide === 'hours').length;
        const decisionSpeed = rapidDecisions / decisions.length > 0.5 ? 'Rapid' : 'Deliberate';

        const highStakesDecisions = decisions.filter(d => d.stakes === 'high');
        let boldScore = 0;
        if (highStakesDecisions.length > 0) {
          const avgConfidenceOnHighStakes = highStakesDecisions.reduce((sum, d) => sum + d.confidence, 0) / highStakesDecisions.length;
          if (avgConfidenceOnHighStakes > 65) boldScore = 1.0; 
        } else {
          const mediumStakes = decisions.filter(d => d.stakes === 'medium');
          if (mediumStakes.length > 0) {
            const avgConfMedium = mediumStakes.reduce((sum, d) => sum + d.confidence, 0) / mediumStakes.length;
            boldScore = (avgConfMedium > 70) ? 0.6 : 0.3;
          }
        }
        const riskTolerance = boldScore > 0.5 ? 'Bold' : 'Conservative';

        let comprehensiveScore = 0;
        decisions.forEach(d => {
          if (d.timeToDecide === 'weeks') comprehensiveScore += 2;
          if (d.timeToDecide === 'days') comprehensiveScore += 1;
          if (d.alternativesConsidered && d.alternativesConsidered.length > 30) comprehensiveScore += 1;
          if (d.evidence && d.evidence.length > 120) comprehensiveScore += 1;
        });
        const informationNeed = (comprehensiveScore / decisions.length) > 1.0 ? 'Comprehensive' : 'Sufficient';

        const key = `${thinkingStyle}-${decisionSpeed}-${riskTolerance}-${informationNeed}`;
        const profile = QuadrantSystem.types[key] || QuadrantSystem.types['Analytical-Deliberate-Conservative-Sufficient'];

        const currentProfile = Storage.loadSync().profile || {};

        return {
          ...profile,
          dimensions: { thinkingStyle, decisionSpeed, riskTolerance, informationNeed },
          key,
          displayName: currentProfile.displayName,
          values: currentProfile.values || [],
          selfAssessment: currentProfile.selfAssessment
        };
      }
    };

    // ==================== ANALYTICS ENGINE ====================
    const AnalyticsEngine = {
      
      calculateAccuracy: (decisions) => {
        const completed = decisions.filter(d => d.outcome !== null);
        if (completed.length === 0) return null;
        const correct = completed.filter(d => d.prediction === d.outcome).length;
        return (correct / completed.length) * 100;
      },
      
      calculateFilteredAccuracy: (decisions, filterFn) => {
        const filtered = decisions.filter(filterFn);
        const completed = filtered.filter(d => d.outcome !== null);
        if (completed.length === 0) return { accuracy: null, count: 0 };
        const correct = completed.filter(d => d.prediction === d.outcome).length;
        return {
          accuracy: (correct / completed.length) * 100,
          count: completed.length
        };
      },

      checkForSelfServingBias: (decisions) => {
        const completed = decisions.filter(d => d.outcome !== null && d.attribution);
        if (completed.length < 5) return null;

        let internalSuccesses = 0;
        let externalFailures = 0;
        let totalSuccesses = 0;
        let totalFailures = 0;
        
        completed.forEach(d => {
          const isCorrect = d.prediction === d.outcome;
          
          if (isCorrect) {
            totalSuccesses++;
            if (d.attribution === 'my_skill') internalSuccesses++;
          } else {
            totalFailures++;
            if (d.attribution === 'external') externalFailures++;
          }
        });

        if (totalSuccesses === 0 || totalFailures === 0) return null;

        const internalSuccessRate = internalSuccesses / totalSuccesses;
        const externalFailureRate = externalFailures / totalFailures;

        if (internalSuccessRate > 0.6 && externalFailureRate > 0.6) {
          return { severity: 'high', message: "You exhibit a strong Self-Serving Bias. You tend to take credit for wins and blame losses on external factors." };
        }
        
        if (internalSuccessRate > 0.5 && externalFailureRate > 0.5) {
          return { severity: 'medium', message: "You show signs of a Self-Serving Bias. Try to be more objective." };
        }
        
        return { severity: 'low', message: "Your attribution of outcomes is generally balanced." };
      },

      getConsistencyScore: (decisions) => {
        if (decisions.length < 5) return { score: 100, deviation: 0, isLow: false };
        
        const timeMap = { 'instant': 1, 'hours': 4, 'days': 48, 'weeks': 168 };
        const timeToDecideValues = decisions.map(d => timeMap[d.timeToDecide] || 48);
        
        const avgTime = timeToDecideValues.reduce((a, b) => a + b, 0) / timeToDecideValues.length;
        const avgConfidence = decisions.reduce((sum, d) => sum + d.confidence, 0) / decisions.length;
        
        const recent = decisions.slice(-5);
        if (recent.length < 3) return { score: 100, deviation: 0, isLow: false };

        let totalDeviation = 0;
        
        recent.forEach(d => {
          const timeDeviation = Math.abs((timeMap[d.timeToDecide] || 48) - avgTime) / avgTime;
          const confidenceDeviation = Math.abs(d.confidence - avgConfidence) / 100; 
          
          totalDeviation += (timeDeviation * 0.5) + (confidenceDeviation * 0.5);
        });

        const averageDeviation = totalDeviation / recent.length;
        const score = Math.max(0, 100 - (averageDeviation * 100));

        return { 
          score: score.toFixed(0), 
          deviation: averageDeviation.toFixed(2),
          isLow: score < 70
        };
      },

      getContextualBlindSpot: (decisions, userQuery) => {
        const lowerQuery = userQuery.toLowerCase();
        
        let domainFocus = null;
        if (lowerQuery.includes('invest') || lowerQuery.includes('stock') || lowerQuery.includes('crypto') || lowerQuery.includes('money') || lowerQuery.includes('financial')) {
          domainFocus = 'financial';
        } else if (lowerQuery.includes('job') || lowerQuery.includes('career') || lowerQuery.includes('promotion') || lowerQuery.includes('work') || lowerQuery.includes('business')) {
          domainFocus = 'career';
        } else if (lowerQuery.includes('relationship') || lowerQuery.includes('friend') || lowerQuery.includes('partner') || lowerQuery.includes('conflict') || lowerQuery.includes('team')) {
          domainFocus = 'relationships';
        } else if (lowerQuery.includes('health') || lowerQuery.includes('diet') || lowerQuery.includes('fitness') || lowerQuery.includes('wellbeing') || lowerQuery.includes('sleep')) {
          domainFocus = 'health';
        }

        if (domainFocus) {
          const { accuracy, count } = AnalyticsEngine.calculateFilteredAccuracy(decisions, d => d.domain === domainFocus);
          if (count > 2 && accuracy < 60) {
            return { type: 'domain', focus: domainFocus, accuracy: accuracy.toFixed(0), message: `Your accuracy in ${domainFocus} decisions is low (${accuracy.toFixed(0)}%).` };
          }
        }
        
        const consistency = AnalyticsEngine.getConsistencyScore(decisions);
        if (consistency.isLow) {
           return { type: 'consistency', focus: 'erratic_process', message: `Your decision-making process is becoming erratic (Consistency Score: ${consistency.score}!).` };
        }
        
        const bias = AnalyticsEngine.checkForSelfServingBias(decisions);
        if (bias && bias.severity === 'high') {
          return { type: 'bias', focus: 'self_serving', message: bias.message };
        }
        
        return { type: 'none', focus: 'general', message: 'You are performing well. Let\'s focus on reinforcement.' };
      },

      generateAgentResponse: (decisions, profile, userQuery) => {
        const defaultResponse = {
          message: "I need more data to be a useful friend! Log at least 5 decisions and 3 completed outcomes.",
          insights: ["Track decisions consistently", "Be honest about outcomes"],
          actionSteps: ["Log your next decision today", "Set a reminder to track outcomes"],
          searchQuery: "how to log decisions consistently"
        };

        const completed = decisions.filter(d => d.outcome !== null);
        if (completed.length < 3) return defaultResponse;
        
        const accuracy = AnalyticsEngine.calculateAccuracy(decisions);
        const blindSpot = AnalyticsEngine.getContextualBlindSpot(decisions, userQuery);
        const bsType = blindSpot.type;
        const bsFocus = blindSpot.focus;
        
        let generalSearchQuery = userQuery;
        let personalizedInsight = "";
        let actionSteps = [];
        
        if (userQuery.toLowerCase().trim() !== 'get insight') {
          
          if (bsType === 'domain' && profile.dimensions.riskTolerance === 'Bold') {
              personalizedInsight = `I see your query. Given your Bold style and low ${bsFocus} accuracy (${blindSpot.accuracy}%), the best external information for you is structured risk mitigation.`;
              generalSearchQuery = `${userQuery} + structured risk mitigation strategies for ${bsFocus} + avoid impulsive action`;
              actionSteps = [`Search for a "pre-mortem" exercise related to ${bsFocus}.`, `Reduce your confidence prediction by 20% on your next ${bsFocus} decision.`];
              
          } else if (bsType === 'bias' || bsType === 'consistency') {
              personalizedInsight = `Your query relates to the external world, but our data shows your process is the current blocker (${blindSpot.message}). External information is only useful if your internal process is sound.`;
              generalSearchQuery = `${userQuery} + how to objectively assess process failure + decision journaling methods`;
              actionSteps = [`Write down your 'Attribution' for your last three outcomes. Were they honest?`, `Focus on your core strength: ${profile.strengths[0]} before executing any search result.`];
              
          } else if (profile.dimensions.thinkingStyle === 'Intuitive' && bsType === 'confidence') {
              personalizedInsight = `As an Intuitive thinker, your gut is powerful, but your miscalibration means you need solid proof. I'm searching for objective data to test your intuition.`;
              generalSearchQuery = `objective data on ${userQuery} + external expert consensus + statistical validation`;
              actionSteps = [`Before acting on the search results, find one piece of data that contradicts your intuition.`, `Log an updated decision in 48 hours to track confidence drift.`];
              
          } else {
              personalizedInsight = `Your overall performance is ${accuracy.toFixed(0)}%. As a ${profile.title}, I'll filter the world's information to reinforce your strength in ${profile.strengths[0]}.`;
              generalSearchQuery = `leveraging ${profile.strengths[0]} in the context of ${userQuery}`;
              actionSteps = [`Think about how the search results align with your core value of ${profile.values && profile.values.length > 0 ? profile.values[0] : 'Growth'}.`, `Share the search result with a colleague to test its rigor.`];
          }

          return {
            message: userQuery,
            insights: [personalizedInsight],
            actionSteps: actionSteps,
            searchQuery: generalSearchQuery
          };

        } else {
          
          const overallBlindSpot = AnalyticsEngine.getContextualBlindSpot(decisions, 'general');

          let message = `Hello, ${profile.displayName || 'Friend'}. Your overall accuracy is ${accuracy.toFixed(0)}%. My current focus is your ${overallBlindSpot.message}`;
          let suggestion = "";
          let searchQuery = "";
          actionSteps = [];

          if (overallBlindSpot.type === 'consistency') {
            suggestion = `You're deviating from your norms. As a ${profile.title}, you excel with structure. My advice is to pause and explicitly write down your Confidence and Evidence before proceeding.`;
            searchQuery = `how to improve consistency in decision making process`;
            actionSteps = ["Review the average time and confidence of your last 5 decisions", "Take a 24-hour break before the next major decision."];
            
          } else if (overallBlindSpot.type === 'bias') {
            suggestion = `The data shows you might be avoiding responsibility for losses (Self-Serving Bias). Next time you fail, consciously attribute the cause to a lack of skill or poor process.`;
            searchQuery = `strategies to overcome self-serving bias in professional context`;
            actionSteps = ["Find one example of a failure and write down three internal reasons for it.", "Review your attribution rates in the Charts section."];
          
          } else if (overallBlindSpot.type === 'domain') {
            suggestion = `Your ${overallBlindSpot.focus.toUpperCase()} decisions are struggling. As a ${profile.title}, you need ${profile.dimensions.informationNeed === 'Comprehensive' ? 'more external data/experts' : 'a quicker feedback loop'} for this domain.`;
            searchQuery = `best practices for ${overallBlindSpot.focus} decision making and risk assessment`;
            actionSteps = [`Seek an expert opinion for the next ${overallBlindSpot.focus} decision.`, `Log the exact data points you used for your next ${overallBlindSpot.focus} decision.`];
          
          } else {
             message = `You're performing well! Your overall accuracy is ${accuracy.toFixed(0)}%. Let's reinforce your strengths.`;
             suggestion = `Your profile is a ${profile.title}. Leverage your top strength: ${profile.strengths[0]}. Think about how you can teach this skill to someone else.`;
             searchQuery = `how to leverage the strengths of a ${profile.title} decision style`;
             actionSteps = ["Write down your favorite success story where you used your primary strength.", "Mentor a colleague on one of your strengths."];
          }

          return {
            message: message,
            insights: [suggestion],
            actionSteps: actionSteps,
            searchQuery: searchQuery
          };
        }
      }
    };

    // ==================== STORAGE ====================
    const Storage = {
      loadSync() { 
        try {
          const result = localStorage.getItem('calibrate_v6_data');
          return result ? JSON.parse(result) : {};
        } catch (e) {
          console.error('Storage sync load error:', e);
          return {};
        }
      },

      async load() {
        return Storage.loadSync();
      },

      async save(data) {
        try {
          localStorage.setItem('calibrate_v6_data', JSON.stringify(data));
          return true;
        } catch (e) {
          console.error('Storage save error:', e);
          return false;
        }
      }
    };

    // ==================== COMPONENTS ====================
    const Modal = ({ children, onClose }) => (
      h('div', { 
        className: "fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",
        onClick: (e) => e.target === e.currentTarget && onClose()
      },
        h('div', { className: "cosmic-card w-full max-w-2xl h-[85vh] flex flex-col rounded-2xl overflow-hidden" },
          children
        )
      )
    );

    const PromptChip = ({ label, onClick }) => (
      h('button', { 
        onClick: onClick,
        className: "px-4 py-2 rounded-full text-xs font-light tracking-wide cosmic-card hover:cosmic-glow transition-all whitespace-nowrap"
      }, label)
    );

    const DecisionAssistant = ({ userData, setUserData, onClose }) => {
      const decisions = userData.decisions;
      const profile = QuadrantSystem.assessFromDecisions(decisions);
      const [chatInput, setChatInput] = useState('');
      const chatEndRef = useRef(null);
      
      const initialAgentResponse = useMemo(() => {
        if (!profile) return null;
        return AnalyticsEngine.generateAgentResponse(decisions, profile, 'get insight');
      }, [decisions, profile]);

      const [chatMessages, setChatMessages] = useState(
        initialAgentResponse ? [{ role: 'assistant', ...initialAgentResponse }] : []
      );

      useEffect(() => {
        if (chatEndRef.current) {
          chatEndRef.current.scrollIntoView({ behavior: 'smooth' });
        }
      }, [chatMessages]);
      
      const handleQuery = (query) => {
        const finalQuery = query || chatInput;
        if (!finalQuery.trim()) return;
        
        setChatMessages(prev => [...prev, { role: 'user', content: finalQuery }]);
        setChatInput('');

        const insight = AnalyticsEngine.generateAgentResponse(decisions, profile, finalQuery);

        setTimeout(() => {
          setChatMessages(prev => [...prev, {
            role: 'assistant',
            ...insight
          }]);
        }, 500);
      };

      if (!profile) {
        return h(Modal, { onClose },
          h('div', { className: "text-center p-12" },
            h('div', { className: "inline-block animate-float mb-6" },
              h(Moon, { className: "w-20 h-20 text-purple-400" })
            ),
            h('h3', { className: "text-2xl serif mb-3" }, "Agent Dormant"),
            h('p', { className: "text-gray-400 font-light" }, "Need at least 5 decisions and 3 outcomes to awaken the oracle.")
          )
        );
      }

      return h(Modal, { onClose },
        h('div', { className: "flex flex-col h-full" },
          h('div', { className: "relative p-6 border-b border-white/10" },
            h('button', { 
              onClick: onClose, 
              className: "absolute top-6 right-6 text-gray-400 hover:text-white transition-colors"
            },
              h(X, { className: "w-5 h-5" })
            ),
            h('div', { className: "flex items-center gap-3" },
              h(Sparkles, { className: "w-6 h-6 text-purple-400" }),
              h('h3', { className: "text-2xl serif" }, "Your Oracle")
            ),
            h('p', { className: "text-sm text-gray-400 mt-2 font-light" }, "Personalized guidance from your decision patterns")
          ),

          h('div', { className: "flex-1 overflow-y-auto p-6 space-y-6" },
            chatMessages.map((msg, idx) =>
              h('div', { 
                key: idx, 
                className: `message-bubble ${msg.role === 'user' ? 'text-right' : 'text-left'}`
              },
                h('div', { 
                  className: `inline-block max-w-[85%] p-4 rounded-2xl ${
                    msg.role === 'user' 
                      ? 'bg-gradient-to-br from-purple-600 to-blue-600 text-white' 
                      : 'cosmic-card'
                  }`,
                  style: msg.role === 'assistant' ? { borderLeft: '2px solid rgba(139, 92, 246, 0.5)' } : {}
                },
                  msg.role === 'user' ? (
                    h('p', { className: "text-sm font-light" }, msg.content)
                  ) : (
                    h(Fragment, null,
                      h('div', { className: "text-xs uppercase tracking-widest text-purple-400 mb-3 font-light" },
                        msg.message === 'get insight' ? 'PERSONAL READING' : 'COSMIC FILTER'
                      ),
                      
                      msg.message !== 'get insight' && h('p', { 
                        className: "text-sm text-gray-400 italic mb-4 font-light",
                        dangerouslySetInnerHTML: { __html: `Interpreting <span class="text-white">"${msg.message}"</span> through your patterns...` }
                      }),
                      
                      msg.insights && msg.insights.length > 0 && h('div', { className: "space-y-3" },
                        msg.insights.map((insight, i) =>
                          h('div', { 
                            key: i, 
                            className: "text-sm leading-relaxed font-light",
                            dangerouslySetInnerHTML: { __html: insight.replace(/\*\*(.*?)\*\*/g, '<span class="text-purple-300">$1</span>') }
                          })
                        )
                      ),

                      msg.searchQuery && h('div', { className: "mt-4 pt-4 border-t border-white/10" },
                        h('div', { className: "text-xs uppercase tracking-widest text-blue-400 mb-2 flex items-center gap-2 font-light" },
                          h(Search, { className: "w-3 h-3" }),
                          "External Knowledge"
                        ),
                        h('a', {
                          href: `https://www.google.com/search?q=${encodeURIComponent(msg.searchQuery)}`,
                          target: "_blank",
                          rel: "noopener noreferrer",
                          className: "text-xs text-blue-300 hover:text-blue-200 underline block break-words font-light"
                        }, msg.searchQuery)
                      ),
                      
                      msg.actionSteps && msg.actionSteps.length > 0 && h('div', { className: "mt-4 pt-4 border-t border-white/10" },
                        h('div', { className: "text-xs uppercase tracking-widest text-green-400 mb-3 font-light" }, "Next Steps"),
                        h('div', { className: "space-y-2" },
                          msg.actionSteps.map((step, i) =>
                            h('div', { key: i, className: "flex items-start gap-3" },
                              h('div', { className: "w-5 h-5 rounded-full border border-green-400/30 flex items-center justify-center flex-shrink-0 mt-0.5" },
                                h('span', { className: "text-xs text-green-400" }, i + 1)
                              ),
                              h('p', { className: "text-xs text-gray-300 font-light flex-1" }, step)
                            )
                          )
                        )
                      )
                    )
                  )
                )
              )
            ),
            h('div', { ref: chatEndRef })
          ),

          h('div', { className: "p-6 border-t border-white/10" },
            h('div', { className: "text-xs uppercase tracking-widest text-gray-500 mb-3 font-light" }, "Suggested Queries"),
            h('div', { className: "flex gap-2 mb-4 overflow-x-auto pb-1" },
              h(PromptChip, { label: "Crypto investing?", onClick: () => handleQuery("How do I invest in crypto?") }),
              h(PromptChip, { label: "My blind spots", onClick: () => handleQuery("get insight") }),
              h(PromptChip, { label: "Career advice", onClick: () => handleQuery("How to ask for a raise?") })
            ),
            h('form', { 
              onSubmit: (e) => { e.preventDefault(); handleQuery(); },
              className: "flex gap-2"
            },
              h('input', {
                type: "text",
                value: chatInput,
                onChange: (e) => setChatInput(e.target.value),
                placeholder: "Ask your oracle...",
                className: "flex-1 px-4 py-3 cosmic-card rounded-xl focus:outline-none focus:ring-1 focus:ring-purple-500 text-sm font-light"
              }),
              h('button', {
                type: "submit",
                className: "bg-gradient-to-br from-purple-600 to-blue-600 text-white p-3 rounded-xl hover:opacity-90 transition-opacity"
              },
                h(Send, { className: "w-5 h-5" })
              )
            )
          )
        )
      );
    };

    // ==================== MAIN APP ====================
    const Calibrate = () => {
      const [loading, setLoading] = useState(true);
      const [showAssistant, setShowAssistant] = useState(false);
      const [userData, setUserData] = useState({
        onboardingComplete: false,
        decisions: [],
        joinedDate: new Date().toISOString(),
        profile: {
          displayName: 'Demo User',
          professionalRole: 'Product Manager',
          professionalBio: 'Experienced PM with focus on data-driven decisions',
          goals: ['Improve financial decisions', 'Be more confident in high-stakes situations'],
          values: ['Growth', 'Integrity', 'Impact'],
          selfAssessment: { 
            thinkingStyle: 'Analytical',
            decisionSpeed: 'Deliberate',
            riskTolerance: 'Bold',
            informationNeed: 'Comprehensive'
          }
        }
      });

      useEffect(() => {
        const loadData = async () => {
          const saved = await Storage.load();
          if (saved && Object.keys(saved).length > 0 && saved.decisions && saved.decisions.length > 0) {
            setUserData(saved);
          } else {
            const demoDecisions = [
              {
                id: 1,
                title: "Accept job offer at TechCorp",
                prediction: "positive",
                confidence: 75,
                evidence: "Higher salary, better growth opportunities",
                domain: "career",
                stakes: "high",
                emotionalState: "neutral",
                timeToDecide: "days",
                alternativesConsidered: "Stay at current company, freelancing",
                decisionBasis: "Data/Analysis",
                date: new Date(Date.now() - 90 * 24 * 60 * 60 * 1000).toISOString(),
                outcome: "positive",
                attribution: "my_skill",
                outcomeDate: new Date(Date.now() - 60 * 24 * 60 * 60 * 1000).toISOString()
              },
              {
                id: 2,
                title: "Invest in cryptocurrency portfolio",
                prediction: "positive",
                confidence: 80,
                evidence: "Market trends look favorable",
                domain: "financial",
                stakes: "high",
                emotionalState: "anxious",
                timeToDecide: "instant",
                alternativesConsidered: "Index funds, real estate",
                decisionBasis: "Gut/Intuition",
                date: new Date(Date.now() - 60 * 24 * 60 * 60 * 1000).toISOString(),
                outcome: "negative",
                attribution: "external",
                outcomeDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString()
              },
              {
                id: 3,
                title: "Launch new product feature early",
                prediction: "positive",
                confidence: 70,
                evidence: "Customer feedback is positive",
                domain: "career",
                stakes: "medium",
                emotionalState: "calm",
                timeToDecide: "days",
                alternativesConsidered: "Wait for more testing, MVP approach",
                decisionBasis: "Data/Analysis",
                date: new Date(Date.now() - 45 * 24 * 60 * 60 * 1000).toISOString(),
                outcome: "positive",
                attribution: "my_skill",
                outcomeDate: new Date(Date.now() - 20 * 24 * 60 * 60 * 1000).toISOString()
              },
              {
                id: 4,
                title: "Invest in another crypto project",
                prediction: "positive",
                confidence: 85,
                evidence: "Strong community, innovative tech",
                domain: "financial",
                stakes: "high",
                emotionalState: "anxious",
                timeToDecide: "instant",
                alternativesConsidered: "Traditional stocks, bonds",
                decisionBasis: "Gut/Intuition",
                date: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString(),
                outcome: "negative",
                attribution: "external",
                outcomeDate: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000).toISOString()
              },
              {
                id: 5,
                title: "Hire senior engineer for team",
                prediction: "positive",
                confidence: 65,
                evidence: "Strong technical skills, good culture fit",
                domain: "career",
                stakes: "medium",
                emotionalState: "neutral",
                timeToDecide: "weeks",
                alternativesConsidered: "Promote internally, contract worker",
                decisionBasis: "Data/Analysis",
                date: new Date(Date.now() - 20 * 24 * 60 * 60 * 1000).toISOString(),
                outcome: "positive",
                attribution: "my_skill",
                outcomeDate: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString()
              },
              {
                id: 6,
                title: "Start new exercise routine",
                prediction: "positive",
                confidence: 60,
                evidence: "Have gym membership, motivated",
                domain: "health",
                stakes: "low",
                emotionalState: "calm",
                timeToDecide: "days",
                alternativesConsidered: "Home workouts, yoga classes",
                decisionBasis: "Gut/Intuition",
                date: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000).toISOString(),
                outcome: null,
                outcomeDate: null
              }
            ];
            
            setUserData(prev => ({
              ...prev,
              decisions: demoDecisions,
              onboardingComplete: true
            }));
          }
          setLoading(false);
        };
        loadData();
      }, []);

      useEffect(() => {
        if (!loading) {
          Storage.save(userData);
        }
      }, [userData, loading]);

      if (loading) {
        return h('div', { className: "min-h-screen cosmic-bg flex items-center justify-center" },
          h('div', { className: "text-center" },
            h('div', { className: "inline-block animate-float mb-4" },
              h(Moon, { className: "w-16 h-16 text-purple-400" })
            ),
            h('p', { className: "text-gray-400 font-light tracking-wide" }, "Loading your cosmos...")
          )
        );
      }

      const profile = QuadrantSystem.assessFromDecisions(userData.decisions);
      const completedCount = userData.decisions.filter(d => d.outcome !== null).length;
      const accuracy = profile ? AnalyticsEngine.calculateAccuracy(userData.decisions) : null;
      const financialAcc = profile ? AnalyticsEngine.calculateFilteredAccuracy(userData.decisions, d => d.domain === 'financial').accuracy : null;

      return h('div', { className: "min-h-screen cosmic-bg relative overflow-hidden" },
        // Constellation background dots
        h('div', { className: "absolute inset-0 overflow-hidden pointer-events-none" },
          Array.from({ length: 50 }).map((_, i) =>
            h('div', {
              key: i,
              className: "constellation-dot",
              style: {
                left: `${Math.random() * 100}%`,
                top: `${Math.random() * 100}%`,
                animationDelay: `${Math.random() * 3}s`
              }
            })
          )
        ),

        // Header
        h('div', { className: "relative border-b border-white/10" },
          h('div', { className: "max-w-5xl mx-auto px-6 py-6" },
            h('div', { className: "flex items-center justify-between" },
              h('div', { className: "flex items-center gap-3" },
                h(Brain, { className: "w-8 h-8 text-purple-400" }),
                h('div', null,
                  h('h1', { className: "text-2xl serif" }, "Calibrate"),
                  h('p', { className: "text-xs text-gray-500 font-light tracking-widest uppercase" }, "Decision Oracle")
                )
              ),
              h('button', {
                onClick: () => setShowAssistant(true),
                className: "px-5 py-2.5 rounded-full font-light tracking-wide text-sm cosmic-card hover:cosmic-glow transition-all flex items-center gap-2"
              },
                h(Sparkles, { className: "w-4 h-4" }),
                "Consult Oracle"
              )
            )
          )
        ),

        // Main content
        h('div', { className: "relative max-w-5xl mx-auto px-6 py-12" },
          h('div', { className: "space-y-8" },
            // Hero section
            h('div', { className: "text-center mb-16" },
              h('div', { className: "inline-block animate-float mb-6" },
                h(Eye, { className: "w-16 h-16 text-purple-400" })
              ),
              h('h2', { className: "text-4xl serif mb-4 gradient-text" }, 
                userData.profile.displayName
              ),
              h('p', { className: "text-gray-400 font-light text-lg" }, 
                userData.profile.professionalRole
              )
            ),

            // Stats orbs
            h('div', { className: "grid grid-cols-2 md:grid-cols-4 gap-6 mb-12" },
              h('div', { className: "stat-orb rounded-3xl p-6 text-center" },
                h('div', { className: "text-4xl font-light mb-2" }, userData.decisions.length),
                h('div', { className: "text-xs uppercase tracking-widest text-gray-400" }, "Decisions")
              ),
              h('div', { className: "stat-orb rounded-3xl p-6 text-center" },
                h('div', { className: "text-4xl font-light mb-2" }, completedCount),
                h('div', { className: "text-xs uppercase tracking-widest text-gray-400" }, "Outcomes")
              ),
              h('div', { className: "stat-orb rounded-3xl p-6 text-center" },
                h('div', { className: "text-4xl font-light mb-2" }, 
                  accuracy ? `${accuracy.toFixed(0)}%` : '—'
                ),
                h('div', { className: "text-xs uppercase tracking-widest text-gray-400" }, "Accuracy")
              ),
              h('div', { className: "stat-orb rounded-3xl p-6 text-center border-2 border-red-500/30" },
                h('div', { className: "text-4xl font-light mb-2 text-red-400" }, 
                  financialAcc !== null ? `${financialAcc.toFixed(0)}%` : '—'
                ),
                h('div', { className: "text-xs uppercase tracking-widest text-red-300" }, "Financial")
              )
            ),

            // Profile card
            profile && h('div', { className: "cosmic-card rounded-3xl p-8 mb-8" },
              h('div', { className: "text-xs uppercase tracking-widest text-purple-400 mb-4 font-light" }, "Your Archetype"),
              h('h3', { className: "text-3xl serif mb-3" }, profile.title),
              h('p', { className: "text-gray-400 mb-6 font-light leading-relaxed" }, profile.description),
              
              h('div', { className: "cosmic-divider mb-6" }),
              
              h('div', { className: "grid grid-cols-2 md:grid-cols-4 gap-4 mb-6" },
                h('div', null,
                  h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Thinking"),
                  h('div', { className: "text-purple-300 font-light" }, profile.dimensions.thinkingStyle)
                ),
                h('div', null,
                  h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Speed"),
                  h('div', { className: "text-purple-300 font-light" }, profile.dimensions.decisionSpeed)
                ),
                h('div', null,
                  h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Risk"),
                  h('div', { className: "text-purple-300 font-light" }, profile.dimensions.riskTolerance)
                ),
                h('div', null,
                  h('div', { className: "text-xs text-gray-500 mb-1 uppercase tracking-wider" }, "Info Need"),
                  h('div', { className: "text-purple-300 font-light" }, profile.dimensions.informationNeed)
                )
              ),
              
              h('div', { className: "cosmic-divider mb-6" }),
              
              h('div', null,
                h('div', { className: "text-xs uppercase tracking-widest text-gray-500 mb-3" }, "Strengths"),
                h('div', { className: "flex flex-wrap gap-2 mb-6" },
                  profile.strengths.map((strength, i) =>
                    h('span', { 
                      key: i, 
                      className: "px-3 py-1.5 rounded-full text-xs font-light border border-green-500/30 text-green-300"
                    }, strength)
                  )
                ),
                h('div', { className: "text-xs uppercase tracking-widest text-gray-500 mb-3" }, "Blind Spots"),
                h('div', { className: "flex flex-wrap gap-2" },
                  profile.blindSpots.map((spot, i) =>
                    h('span', { 
                      key: i, 
                      className: "px-3 py-1.5 rounded-full text-xs font-light border border-red-500/30 text-red-300"
                    }, spot)
                  )
                )
              )
            ),

            // Alert card
            financialAcc === 0 && h('div', { className: "cosmic-card rounded-3xl p-8 border-2 border-red-500/30 mb-8" },
              h('div', { className: "flex items-start gap-4" },
                h('div', { className: "w-12 h-12 rounded-full bg-red-500/20 flex items-center justify-center flex-shrink-0" },
                  h(Eye, { className: "w-6 h-6 text-red-400" })
                ),
                h('div', { className: "flex-1" },
                  h('h3', { className: "text-xl serif mb-2 text-red-300" }, "Financial Pattern Detected"),
                  h('p', { className: "text-gray-400 mb-4 font-light leading-relaxed" }, 
                    "Your accuracy in financial decisions is 0%. As a Bold, Analytical thinker, you may be over-trusting your analysis in volatile markets. The oracle suggests caution."
                  ),
                  h('button', {
                    onClick: () => setShowAssistant(true),
                    className: "px-4 py-2 rounded-full text-sm font-light cosmic-card hover:cosmic-glow transition-all"
                  }, "Consult Oracle →")
                )
              )
            ),

            // Action cards
            h('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-6" },
              h('button', { 
                className: "cosmic-card rounded-3xl p-8 hover:cosmic-glow transition-all text-left group"
              },
                h('div', { className: "mb-6 opacity-60 group-hover:opacity-100 transition-opacity" },
                  h('svg', { 
                    className: "w-10 h-10 text-purple-400",
                    viewBox: "0 0 24 24",
                    fill: "none",
                    stroke: "currentColor",
                    strokeWidth: "1.5"
                  },
                    h('path', { d: "M12 5v14M5 12h14" })
                  )
                ),
                h('h3', { className: "text-xl serif mb-2" }, "Log Decision"),
                h('p', { className: "text-sm text-gray-500 font-light" }, "Record a new prediction")
              ),

              h('button', { 
                className: "cosmic-card rounded-3xl p-8 hover:cosmic-glow transition-all text-left group"
              },
                h('div', { className: "mb-6 opacity-60 group-hover:opacity-100 transition-opacity" },
                  h('svg', { 
                    className: "w-10 h-10 text-blue-400",
                    viewBox: "0 0 24 24",
                    fill: "none",
                    stroke: "currentColor",
                    strokeWidth: "1.5"
                  },
                    h('path', { d: "M3 3v16a2 2 0 0 0 2 2h16" }),
                    h('path', { d: "M18 17V9M13 17V5M8 17v-3" })
                  )
                ),
                h('h3', { className: "text-xl serif mb-2" }, "View Charts"),
                h('p', { className: "text-sm text-gray-500 font-light" }, "Explore your patterns")
              ),

              h('button', { 
                onClick: () => setShowAssistant(true),
                className: "cosmic-card rounded-3xl p-8 cosmic-glow text-left group relative overflow-hidden"
              },
                h('div', { 
                  className: "absolute inset-0 bg-gradient-to-br from-purple-600/20 to-blue-600/20 opacity-0 group-hover:opacity-100 transition-opacity"
                }),
                h('div', { className: "relative" },
                  h('div', { className: "mb-6 animate-float" },
                    h(Sparkles, { className: "w-10 h-10 text-purple-300" })
                  ),
                  h('h3', { className: "text-xl serif mb-2" }, "Oracle"),
                  h('p', { className: "text-sm text-gray-500 font-light" }, "Receive guidance")
                )
              )
            )
          )
        ),

        showAssistant && h(DecisionAssistant, {
          userData: userData,
          setUserData: setUserData,
          onClose: () => setShowAssistant(false)
        })
      );
    };

    // ==================== RENDER ====================
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(h(Calibrate));
</script>
```

</body>
</html>